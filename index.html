<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ROSA 1.0 | Statutory Management</title>
    
    <script>
        (function() {
            // Cek session secepat mungkin sebelum render
            const session = localStorage.getItem('rosa_session');
            const html = document.documentElement;
            if (session === 'active') {
                html.classList.add('is-logged-in');
            } else {
                html.classList.add('is-logged-out');
            }

            // Fungsi untuk menampilkan body setelah semuanya siap
            window.revealPage = function() {
                html.classList.add('page-ready');
            };
        })();
    </script>

    <style>
        :root {
            --rosa-primary: #6366f1;
            --danger: #ef4444;
            --warning: #f59e0b;
            --success: #10b981;
            --rosa-dark: #4338ca;
        }

        /* --- Sembunyikan Body Secara Total Sebelum Ready --- */
        body { 
            visibility: hidden; 
            opacity: 0; 
            background-color: #1a253d; /* Warna dasar agar tidak putih saat loading */
        }
        
        /* Tampilkan secara serentak dengan transisi halus */
        html.page-ready body { 
            visibility: visible; 
            opacity: 1; 
            transition: opacity 0.4s ease-in-out; 
        }

        /* --- ANTI-FLICKER LOGIC --- */
        html.is-logged-in #authSection { display: none !important; }
        html.is-logged-in #mainSection { display: block !important; }
        
        html.is-logged-out #authSection { display: flex !important; }
        html.is-logged-out #mainSection { display: none !important; }

        @keyframes fadeInScale {
            from { opacity: 0; transform: scale(0.98) translateY(10px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }

        /* --- TOAST NOTIFICATION --- */
        #toast-container { position: fixed; bottom: 20px; right: 20px; z-index: 9999; }
        .toast {
            background: rgba(15, 23, 42, 0.9); backdrop-filter: blur(8px);
            color: white; padding: 12px 25px; border-radius: 10px;
            border-left: 4px solid var(--rosa-primary); box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            margin-top: 10px; font-size: 14px; animation: slideIn 0.3s ease-out forwards;
            display: flex; align-items: center; gap: 10px;
        }

        /* --- CIRCULAR LOADER ANIMATION --- */
        .loader-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(15, 23, 42, 0.2); 
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            z-index: 11000;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
        }

        .progress-circle {
            position: relative; width: 130px; height: 130px;
            border-radius: 50%; 
            background: conic-gradient(var(--rosa-primary) 0%, rgba(255,255,255,0.05) 0%);
            display: flex; justify-content: center; align-items: center;
            box-shadow: 0 0 30px rgba(99, 102, 241, 0.2);
            transition: background 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            animation: pulseGlow 2s infinite ease-in-out;
        }

        @keyframes pulseGlow {
            0% { transform: scale(1); box-shadow: 0 0 20px rgba(99, 102, 241, 0.2); }
            50% { transform: scale(1.03); box-shadow: 0 0 40px rgba(99, 102, 241, 0.4); }
            100% { transform: scale(1); box-shadow: 0 0 20px rgba(99, 102, 241, 0.2); }
        }

        .progress-circle::before {
            content: ""; position: absolute; width: 115px; height: 115px;
            background: rgba(15, 23, 42, 0.1); 
            border-radius: 50%;
            backdrop-filter: blur(5px);
        }

        #progress-text { 
            position: relative; 
            font-size: 26px; 
            font-weight: 300;
            color: white; 
            text-shadow: 0 0 15px rgba(255,255,255,0.5);
            font-variant-numeric: tabular-nums;
        }

        .loading-msg { 
            margin-top: 25px; 
            font-size: 10px; 
            font-weight: 600;
            letter-spacing: 4px; 
            color: rgba(255,255,255,0.6);
            animation: breathe 2s infinite ease-in-out;
        }

        @keyframes breathe {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.8; }
        }

        /* --- CONFIRMATION MODAL --- */
        .confirm-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); z-index: 10000;
            display: flex; justify-content: center; align-items: center;
        }
        .confirm-box {
            padding: 30px; text-align: center; max-width: 350px; width: 90%;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .doc-name-container {
            max-width: 350px; 
            white-space: normal; 
            word-wrap: break-word; 
            overflow-wrap: break-word;
            text-align: left; 
            line-height: 1.5;
            padding: 10px 0;
            display: block;
        }

        .action-icons { 
            display: flex; 
            gap: 15px; 
            font-size: 1.1rem; 
            justify-content: center; 
            align-items: center;     
            height: 100%;             
            min-height: 40px;
        }

        footer {
            text-align: center; padding: 20px 0; margin-top: 50px; width: 100%;
            background: rgba(0, 0, 0, 0.2); backdrop-filter: blur(5px);
            border-top: 1px solid rgba(255, 255, 255, 0.05); font-size: 13px;
            color: rgba(255, 255, 255, 0.5); letter-spacing: 1px;
        }

        @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        @keyframes fadeOut { to { opacity: 0; transform: translateY(20px); } }

        .window-fade { animation: fadeInScale 0.5s ease-out forwards; }

        body, html { 
            margin: 0; padding: 0; width: 100%; min-height: 100vh;
            font-family: 'Segoe UI', sans-serif;
            background-image: linear-gradient(rgba(34, 46, 74, 0.85), rgba(33, 48, 82, 0.85)), 
                             url('https://images.unsplash.com/photo-1516937941344-00b4e0337589?q=80&w=2070&auto=format&fit=crop');
            background-size: cover; background-position: center; background-attachment: fixed;
            color: white; overflow-x: hidden; display: flex; flex-direction: column;
        }

        .page-content { flex: 1; }
        .top-left-logo { position: absolute; top: 15px; left: 15px; width: 100px; z-index: 100; filter: drop-shadow(0 2px 4px rgba(21,13,13,0.5)); }
        .top-right-logo { position: absolute; top: 15px; right: 15px; width: 100px; z-index: 100; filter: drop-shadow(0 2px 4px rgba(95,50,50,0.5)); }
        .brand-logo { width: 110px; margin-bottom: 15px; filter: drop-shadow(0 0 15px rgba(99,102,241,0.6)); }
        .nav-logo { width: 55px; margin-right: 12px; }
        .hidden { display: none !important; }
        
        .glass-panel {
            background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 15px;
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.4);
        }

        #authSection, #welcomeSection { height: 100vh; display: flex; justify-content: center; align-items: center; position: relative; }
        .card-inner { padding: 2.5rem; width: 90%; max-width: 400px; text-align: center; z-index: 10; }
        #mainSection { width: 95%; max-width: 1100px; margin: 20px auto; padding-bottom: 50px; position: relative; }

        .nav-bar { 
            display: flex; justify-content: space-between; align-items: center; 
            padding: 1rem 0; border-bottom: 1px solid rgba(255,255,255,0.1); 
            margin-bottom: 30px; margin-top: 100px; margin-left: 20px; margin-right: 20px; 
        }

        input, select { 
            width: 100%; padding: 12px; margin: 8px 0; border: none; border-radius: 10px; 
            box-sizing: border-box; font-size: 15px; background: rgba(255,255,255,0.95); color: #0f172a;
        }
        .file-label { display: block; text-align: left; font-size: 11px; color: #94a3b8; margin-bottom: 10px; }

        .btn { padding: 12px 20px; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; transition: 0.2s; width: 100%; margin-top: 5px; }
        .btn-primary { background: var(--rosa-primary); color: white; }
        .btn-danger { background: var(--danger); color: white; }
        .btn-logout { background: rgba(239, 68, 68, 0.2); color: #fca5a5; width: auto; font-size: 0.8rem; border: 1px solid rgba(239, 68, 68, 0.3); }
        .btn-trash { background: rgba(255, 255, 255, 0.1); color: white; width: auto; font-size: 0.8rem; border: 1px solid rgba(255,255,255,0.2); }

        .table-wrapper { overflow-x: auto; margin-top: 10px; }
        table { width: 100%; border-collapse: collapse; min-width: 800px; background: rgba(0, 0, 0, 0.2); border-radius: 12px; overflow: hidden; }
        th { text-align: center; padding: 15px; background: rgba(255,255,255,0.05); font-size: 12px; text-transform: uppercase; color: #94a3b8; }
        td { padding: 15px; border-bottom: 1px solid rgba(255,255,255,0.05); font-size: 14px; text-align: center; }

        .badge { padding: 4px 10px; border-radius: 6px; font-size: 11px; font-weight: bold; min-width: 100px; display: inline-block; text-align: center; }
        .expired { background: var(--danger); }
        .warning { background: var(--warning); color: black; }
        .secure { background: var(--success); }

        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); z-index: 1000; display: flex; justify-content: center; align-items: center;
        }
        .trash-content { width: 90%; max-width: 700px; max-height: 80vh; overflow-y: auto; padding: 25px; }
    </style>
</head>
<body>

    <div id="loaderSection" class="loader-overlay hidden">
        <div class="progress-circle" id="circleBar">
            <span id="progress-text">0%</span>
        </div>
        <div class="loading-msg">INITIALIZING SYSTEM...</div>
    </div>

    <div id="toast-container"></div>
    
    <div id="confirmModal" class="confirm-overlay hidden">
        <div class="confirm-box glass-panel window-fade">
            <h3 style="margin-top:0;" id="confirmTitle">Permanent Delete?</h3>
            <p style="font-size: 14px; opacity: 0.8;" id="confirmDesc">This action cannot be undone.</p>
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button class="btn" style="background: rgba(255,255,255,0.1); color: white;" onclick="closeConfirm()">CANCEL</button>
                <button class="btn btn-danger" id="finalDeleteBtn">DELETE NOW</button>
            </div>
        </div>
    </div>

    <div class="page-content">
        <img src="https://drive.google.com/thumbnail?id=1hwj29w9qzb1NPmwLlnwtwfHrF5DaGq4v&sz=w1000" class="top-left-logo" alt="Danantara">
        <img src="https://drive.google.com/thumbnail?id=1RKW9wGjOiUU33xfnHVafFyLZ0I2ic4gU&sz=w1000" class="top-right-logo" alt="Patra Niaga">

        <div id="authSection" class="window-fade">
            <div class="card-inner glass-panel">
                <img src="https://drive.google.com/thumbnail?id=1cE2310pRHuIoh9yZ8A17rJdTkLnS-Puh&sz=w1000" class="brand-logo" alt="Logo">
                <h1 style="margin:0;">ROSA 1.0</h1>
                <p style="font-size: 10px; opacity: 0.7; letter-spacing: 1px; margin-bottom: 2rem;">REFINERY ORGANIZATION SYSTEM ASSISTANT</p>
                <input type="text" id="username" placeholder="Username">
                <input type="password" id="password" placeholder="Password">
                <button class="btn btn-primary" onclick="handleLogin()">AUTHORIZE ACCESS</button>
            </div>
        </div>

        <div id="welcomeSection" class="hidden">
            <div class="glass-panel card-inner">
                <img src="https://drive.google.com/thumbnail?id=1cE2310pRHuIoh9yZ8A17rJdTkLnS-Puh&sz=w1000" class="brand-logo" alt="Logo">
                <h1>WELCOME</h1>
                <p style="letter-spacing: 2px; color: var(--rosa-primary);">SYSTEM INITIALIZED</p>
                <button class="btn btn-primary" onclick="goToDashboard()">OPEN DASHBOARD</button>
            </div>
        </div>

        <div id="mainSection" class="hidden">
            <div class="nav-bar">
                <div style="display: flex; align-items: center;">
                    <img src="https://drive.google.com/thumbnail?id=1cE2310pRHuIoh9yZ8A17rJdTkLnS-Puh&sz=w1000" class="nav-logo" alt="Logo">
                    <div style="text-align: left;">
                        <strong>ROSA 1.0</strong>
                        <div style="font-size: 10px; opacity: 0.5;">Statutory Management</div>
                    </div>
                </div>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <button class="btn btn-trash" onclick="toggleTrash()">üóëÔ∏è Recycle Bin (<span id="trashCount">0</span>)</button>
                    <button class="btn btn-logout" onclick="handleLogout()">Logout</button>
                </div>
            </div>

            <div class="content">
                <div class="glass-panel" style="padding: 20px; margin-bottom: 20px;">
                    <h3 id="formTitle" style="margin-top:0;">Register Document</h3>
                    <input type="hidden" id="editId">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <div><input type="text" id="docName" placeholder="Name of Document"></div>
                        <div><input type="date" id="startDate"><label class="file-label">Start Date</label></div>
                        <div><input type="date" id="endDate"><label class="file-label">End Date</label></div>
                        <div><input type="file" id="docFile" accept="application/pdf"><label class="file-label">Upload PDF (optional)</label></div>
                    </div>
                    <button class="btn btn-primary" id="saveBtn" onclick="addEntry()">SAVE RECORD</button>
                    <button class="btn hidden" id="cancelBtn" onclick="resetForm()" style="background: rgba(255, 255, 255, 0.1); margin-top:5px;">CANCEL EDIT</button>
                </div>

                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th style="width: 50px;">No.</th>
                                <th style="text-align: left;">Name of Document</th>
                                <th>Start Date</th>
                                <th>End Date</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="listBody"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div id="trashModal" class="modal-overlay hidden">
        <div class="trash-content glass-panel window-fade">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2 style="margin:0;">üóëÔ∏è Recycle Bin</h2>
                <div style="display: flex; gap: 10px;">
                    <button class="btn btn-danger" style="width: auto; font-size: 12px;" onclick="confirmEmptyTrash()">EMPTY BIN</button>
                    <button class="btn btn-logout" onclick="toggleTrash()">Close</button>
                </div>
            </div>
            <div class="table-wrapper">
                <table style="min-width: 100%;">
                    <thead>
                        <tr>
                            <th style="width: 50px;">No.</th>
                            <th style="text-align: left;">Document Name</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="trashBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <footer>
        Copyright ¬© 2026 ROSA 1.0 - Refinery Organization System Assistant
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAAEPfCxGqB8nmQrpku-0DkY30-FVCCZg4",
            authDomain: "rosa-db.firebaseapp.com",
            databaseURL: "https://rosa-db-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "rosa-db",
            storageBucket: "rosa-db.firebasestorage.app",
            messagingSenderId: "564956423327",
            appId: "1:564956423327:web:5e619b93cd363816a52eaa"
        };

        const app = initializeApp(firebaseConfig);
        const rtdb = getDatabase(app);

        window.db = [];
        window.trash = [];

        onValue(ref(rtdb, 'ROSA_STORAGE'), (snapshot) => {
            const data = snapshot.val();
            if (data) {
                window.db = data.db || [];
                window.trash = data.trash || [];
            }
            window.render();
            document.getElementById('trashCount').innerText = window.trash.length;
            
            // Tampilkan halaman hanya setelah data Firebase diterima pertama kali
            window.revealPage();
        });

        // Handler jika Firebase lambat atau gagal
        setTimeout(() => window.revealPage(), 2000);

        window.updateStorage = function() {
            set(ref(rtdb, 'ROSA_STORAGE'), { db: window.db, trash: window.trash });
        };

        window.showToast = function(message, type = 'success') {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = 'toast';
            
            let icon = '‚úÖ'; 
            if(type === 'access-denied') { 
                icon = '‚õî'; 
                toast.style.borderLeftColor = 'var(--danger)';
            } else if(type === 'danger') { 
                icon = 'üóëÔ∏è'; 
                toast.style.borderLeftColor = 'var(--danger)';
            } else if(type === 'info') { 
                icon = 'üîÑ'; 
                toast.style.borderLeftColor = 'var(--warning)';
            }

            toast.innerHTML = `<span>${icon}</span> <span>${message}</span>`;
            container.appendChild(toast);
            setTimeout(() => {
                toast.style.animation = 'fadeOut 0.5s ease-in forwards';
                setTimeout(() => toast.remove(), 500);
            }, 3000);
        };

        window.handleLogin = function() {
            const u = document.getElementById('username').value;
            const p = document.getElementById('password').value;
            if(u.toLowerCase() === 'rosa' && p === '12345') {
                localStorage.setItem('rosa_session', 'active');
                document.documentElement.classList.remove('is-logged-out');
                window.switchWindow('authSection', 'welcomeSection');
            } else {
                window.showToast("Access Denied!", "access-denied");
            }
        };

        window.handleLogout = function() {
            localStorage.removeItem('rosa_session');
            location.reload();
        };

        window.switchWindow = function(hideId, showId) {
            document.getElementById(hideId).classList.add('hidden');
            document.getElementById(showId).classList.remove('hidden');
        };

        window.goToDashboard = function() {
            const loader = document.getElementById('loaderSection');
            const text = document.getElementById('progress-text');
            const circle = document.getElementById('circleBar');
            
            loader.classList.remove('hidden');
            let progress = 0;

            const interval = setInterval(() => {
                progress += 2; 
                text.innerText = progress + "%";
                circle.style.background = `conic-gradient(var(--rosa-primary) ${progress}%, rgba(255,255,255,0.1) 0%)`;

                if (progress >= 100) {
                    clearInterval(interval);
                    setTimeout(() => {
                        loader.classList.add('hidden');
                        document.documentElement.className = 'is-logged-in page-ready'; 
                        window.switchWindow('welcomeSection', 'mainSection');
                        window.render();
                    }, 500);
                }
            }, 30);
        };

        window.addEntry = function() {
            const name = document.getElementById('docName').value;
            const start = document.getElementById('startDate').value;
            const end = document.getElementById('endDate').value;
            const fileInput = document.getElementById('docFile');
            const editId = document.getElementById('editId').value;

            if(!name || !start || !end) return window.showToast("Fill all fields", "info");

            if (fileInput.files[0]) {
                const reader = new FileReader();
                reader.onload = (e) => executeSave(name, start, end, e.target.result, editId);
                reader.readAsDataURL(fileInput.files[0]);
            } else {
                executeSave(name, start, end, editId ? (window.db.find(x => x.id == editId)?.pdf || null) : null, editId);
            }
        };

        function executeSave(name, start, end, pdf, editId) {
            if (editId) {
                const idx = window.db.findIndex(x => x.id == editId);
                if (idx !== -1) window.db[idx] = { id: parseInt(editId), name, start, end, pdf };
                window.showToast("Data Updated Successfully");
            } else {
                window.db.push({ id: Date.now(), name, start, end, pdf });
                window.showToast("New Record Saved");
            }
            window.updateStorage(); window.resetForm(); window.render();
        }

        window.deleteItem = function(id) {
            const item = window.db.find(x => x.id === id);
            window.trash.push(item);
            window.db = window.db.filter(x => x.id !== id);
            window.updateStorage(); window.render();
            window.showToast("Moved to Trash", "danger");
        };

        window.restoreItem = function(id) {
            const item = window.trash.find(x => x.id === id);
            window.db.push(item);
            window.trash = window.trash.filter(x => x.id !== id);
            window.updateStorage(); window.renderTrash(); window.render();
            window.showToast("Data Restored", "info");
        };

        window.confirmEmptyTrash = function() {
            if(window.trash.length === 0) return;
            document.getElementById('confirmTitle').innerText = "Empty Trash?";
            document.getElementById('confirmModal').classList.remove('hidden');
            document.getElementById('finalDeleteBtn').onclick = () => {
                window.trash = []; window.updateStorage(); window.renderTrash();
                window.showToast("Trash Emptied", "danger"); window.closeConfirm();
            };
        };

        window.confirmPermanentDelete = function(id) {
            document.getElementById('confirmTitle').innerText = "Delete Permanently?";
            document.getElementById('confirmModal').classList.remove('hidden');
            document.getElementById('finalDeleteBtn').onclick = () => {
                window.trash = window.trash.filter(x => x.id !== id);
                window.updateStorage(); window.renderTrash();
                window.showToast("Deleted Permanently", "danger"); window.closeConfirm();
            };
        };

        window.closeConfirm = function() { document.getElementById('confirmModal').classList.add('hidden'); };

        window.render = function() {
            const list = document.getElementById('listBody');
            const today = new Date();
            list.innerHTML = '';
            window.db.forEach((item, index) => {
                const diff = Math.ceil((new Date(item.end) - today) / 86400000);
                let stat = "SECURE", cls = "secure";
                if(diff < 0) { stat = "EXPIRED"; cls = "expired"; }
                else if(diff <= 14) { stat = "NEARING EXPIRY"; cls = "warning"; }
                
                list.innerHTML += `<tr>
                    <td style="vertical-align: middle;">${index + 1}</td>
                    <td style="vertical-align: middle; text-align: left;"><div class="doc-name-container"><b>${item.name}</b></div></td>
                    <td style="vertical-align: middle;">${item.start}</td>
                    <td style="vertical-align: middle;">${item.end}</td>
                    <td style="vertical-align: middle;"><span class="badge ${cls}">${stat}</span></td>
                    <td style="vertical-align: middle;">
                        <div class="action-icons">
                            ${item.pdf ? `<span onclick="viewPDF('${item.pdf}')" style="cursor:pointer;">üìÑ</span>` : ''}
                            <span onclick="editItem(${item.id})" style="cursor:pointer;">‚úèÔ∏è</span>
                            <span onclick="deleteItem(${item.id})" style="cursor:pointer;">üóëÔ∏è</span>
                        </div>
                    </td>
                </tr>`;
            });
        };

        window.renderTrash = function() {
            const body = document.getElementById('trashBody');
            body.innerHTML = '';
            window.trash.forEach((item, index) => {
                body.innerHTML += `<tr>
                    <td style="vertical-align: middle;">${index + 1}</td>
                    <td style="vertical-align: middle; text-align: left;"><div class="doc-name-container">${item.name}</div></td>
                    <td style="vertical-align: middle;">
                        <div class="action-icons">
                            <span onclick="restoreItem(${item.id})" style="cursor:pointer;">üîÑ</span>
                            <span onclick="confirmPermanentDelete(${item.id})" style="cursor:pointer;">‚ùå</span>
                        </div>
                    </td>
                </tr>`;
            });
            document.getElementById('trashCount').innerText = window.trash.length;
        };

        window.resetForm = function() {
            document.getElementById('docName').value = ''; document.getElementById('startDate').value = '';
            document.getElementById('endDate').value = ''; document.getElementById('docFile').value = '';
            document.getElementById('editId').value = ''; document.getElementById('formTitle').innerText = 'Register Document';
            document.getElementById('saveBtn').innerText = 'SAVE RECORD'; document.getElementById('cancelBtn').classList.add('hidden');
        };

        window.editItem = function(id) {
            const item = window.db.find(x => x.id == id);
            document.getElementById('docName').value = item.name;
            document.getElementById('startDate').value = item.start;
            document.getElementById('endDate').value = item.end;
            document.getElementById('editId').value = item.id;
            document.getElementById('formTitle').innerText = 'Edit Document Record';
            document.getElementById('saveBtn').innerText = 'UPDATE RECORD';
            document.getElementById('cancelBtn').classList.remove('hidden');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        };

        window.viewPDF = function(base64) {
            const file = new Blob([new Uint8Array(atob(base64.split(',')[1]).split('').map(c => c.charCodeAt(0)))], { type: 'application/pdf' });
            window.open(URL.createObjectURL(file), '_blank');
        };

        window.toggleTrash = function() {
            document.getElementById('trashModal').classList.toggle('hidden');
            window.renderTrash();
        };
    </script>
</body>
</html>
